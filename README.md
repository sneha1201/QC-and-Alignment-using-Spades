# QC-and-Alignment-using-Spades

This repository contains a Python-based pipeline for performing de novo assembly of whole-genome sequencing (WGS) data. The pipeline automates several essential tasks, including quality control (QC) of the raw and trimmed reads, read trimming using fastp, genome assembly using SPAdes, and assembly quality evaluation with QUAST. The pipeline is designed to handle multiple samples in parallel for enhanced efficiency. It outputs various files and reports, including pre- and post-trimmed QC reports, trimmed FASTQ files, SPAdes assembly results (with contigs and other assembly files), and detailed assembly statistics generated by QUAST.

Prerequisites

To run the pipeline, ensure the following tools are installed and accessible on your system:

FastQC - for quality control of raw and trimmed reads

seqkit - for generating sequence statistics

multiqc - for aggregating quality control results into a comprehensive report

fastp - for trimming raw sequence reads

SPAdes - for assembling the reads into contigs

QUAST - for evaluating the quality of the assembly

Additionally, you need Python 3.x with the pandas library, which can be installed via pip install pandas.

Usage

To run the pipeline, use the following command format:


python3 wgs_denovo_assemly.py --sample_info <sample_info_file> --fastq_folder <input_fastq_folder> --output_folder <output_folder> --threads <number_of_threads> --jobs <parallel_jobs>

Arguments:

--sample_info: Path to a tab-separated file containing sample details, including the sample name, FASTQ file names, and pair type (Pair1 or Pair2).

--fastq_folder: Directory containing the raw FASTQ files for all samples.

--output_folder: Directory where all output files (QC reports, trimmed reads, assembly results, etc.) will be stored.

--threads: Number of threads to allocate for each tool (default is 8).

--jobs: Number of parallel jobs to run for trimming, assembly, and evaluation (default is 2).

Example Command:

python3 wgs_denovo_assemly.py --sample_info samples_info.tsv --fastq_folder /path/to/fastq_files --output_folder /path/to/output --threads 8 --jobs 4

Sample Input File (samples_info.tsv)

The samples_info.tsv file should have the following format:

Sample    File Name    Pair

sample1   sample1_R1.fastq.gz   Pair1

sample1   sample1_R2.fastq.gz   Pair2

sample2   sample2_R1.fastq.gz   Pair1

sample2   sample2_R2.fastq.gz   Pair2

Output

The output will be organized in the following structure:

1_QC: Contains pre-trimmed and post-trimmed FASTQ files along with quality control reports generated by fastqc and multiqc.

2_Trimmed: Contains the trimmed FASTQ files generated by fastp.

3_Spades_Assembly: Contains the SPAdes assembly results for each sample, stored in sample-specific subdirectories. Each sample's folder will include the assembled contigs and additional files.

assembly_stats: Contains QUAST-generated assembly statistics for each sample, providing quality metrics like N50, GC content, and other assembly characteristics.

The final directory structure will look like this:

/path/to/output/
│
├── 1_QC/
│   ├── qc_before/
│   ├── qc_after/
│   └── multiqc/
│
├── 2_Trimmed/
│   ├── sample1_1_trimmed.fastq.gz
│   ├── sample1_2_trimmed.fastq.gz
│   ├── sample2_1_trimmed.fastq.gz
│   └── sample2_2_trimmed.fastq.gz
│
├── 3_Spades_Assembly/
│   ├── sample1/
│   │   ├── contigs.fasta
│   │   └── assembly_stats/
│   ├── sample2/
│   │   ├── contigs.fasta
│   │   └── assembly_stats/
│   └── pipeline.log
